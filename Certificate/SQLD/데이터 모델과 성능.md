### 정규화(Normalization)

- 정규화는 데이터의 일관성, 최소한의 데이터 중복, 최대한의 데이터 유연성을 위한 방법이며 데이터를 분해하는 과정이다.
- 정규화는 데이터 중복을 제거하고 데이터 모델의 독립성을 확보하기 위한 방법이다.
- 정규화를 수행하면 비즈니스에 변화가 발생하여도 데이터 모델의 변경을 최소화할 수 있다.
- 정규화는 제1정규화부터 제5정규화까지 있지만, 실질적으로는 제3정규화까지만 수행한다.
- 정규화된 모델은 테이블이 분해된다. 테이블이 분해되면 직원 테이블과 부서 테이블 간에 부서코드로 조인을 수행하여 하나의 합집합으로 만들 수도 있다.
- 정규화를 수행하면 불필요한 데이터를 입력하지 않아도 되기 때문에 중복 데이터가 제거된다.

### 정규화 절차

- 제1정규화
  - 속성의 원자성을 확보한다.
  - 기본키를 설정한다.
- 제2정규화
  - 기본키가 2개 이상의 속성으로 이루어진 경우, **부분 함수 종속성**을 제거한다.
- 제3정규화
  - 기본키를 제외한 칼럼간에 종속성을 제거한다.
  - **이행 함수 종속성**을 제거한다.
- BCNF
  - 기본키를 제외하고 후보키가 있는 경우, 후보키가 기본키를 종속시키면 분해한다.
- 제4정규화
  - 여러 칼럼들이 하나의 칼럼을 종속시키는 경우 분해하여 다중값 종속성을 제거한다.
- 제5정규화
  - 조인에 의해서 종속성이 발생되는 경우 분해한다.

### 함수적 종속성

1. 제1정규화

   - 정규화는 함수적 종속성을 근거로 한다. 함수적 종속성이란 X→Y이면 Y는 X에 함수적으로 종속된다고 말한다.

   - 함수적 종속성은 X가 변화하면 Y도 변화하는지 확인한다.

   - 기본키를 잡는 것이 제1정규화이다.

     ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/f3fb69c1-d156-4860-8013-c2b7b76c35bf/Untitled.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/f3fb69c1-d156-4860-8013-c2b7b76c35bf/Untitled.png)

     ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/737f92c4-588e-408d-b871-401a22e652e9/Untitled.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/737f92c4-588e-408d-b871-401a22e652e9/Untitled.png)

2. 제2정규화

   - 부분 함수 종속성이란, 기본키가 2개 이상의 칼럼으로 이루어진 경우에만 발생한다.

   - 기본키가 하나의 칼럼으로 이루어지면 제2정규화는 생략한다.

     ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/d13bdd87-4fe4-4a89-8161-a378f772f723/Untitled.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/d13bdd87-4fe4-4a89-8161-a378f772f723/Untitled.png)

     ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/a70b6d89-b52e-40c9-9842-ac14fd56d772/Untitled.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/a70b6d89-b52e-40c9-9842-ac14fd56d772/Untitled.png)

     ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/0b27ea25-eae4-4802-8669-67367a72aef3/Untitled.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/0b27ea25-eae4-4802-8669-67367a72aef3/Untitled.png)

3. 제3정규화

   - 제3정규화는 이행 함수 종속성을 제거한다. 이행 함수 종속성이란, 기본키를 제외하고 칼럼간에 종속성이 발생하는 것.

   - 제3정규화는 제1정규화와 제2정규화를 수행한 다음에 해야 한다.

     ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/e5c874e5-eace-4b56-8207-67a50cfcd0a5/Untitled.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/e5c874e5-eace-4b56-8207-67a50cfcd0a5/Untitled.png)

     ![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/dc9ab4a7-f771-4097-903a-b4d6eb1dd293/Untitled.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/dc9ab4a7-f771-4097-903a-b4d6eb1dd293/Untitled.png)

4. BCNF

   - BCNF는 복수의 후보키가 있고, 후보키들이 복합 속성이어야 하며, 서로 중첩되어야 한다.

### 정규화의 문제점

1. 정규화의 문제점

   - 정규화는 테이블을 분해해서 데이터 중복을 제거하기 때문에 데이터 모델의 유연성을 높인다.
   - 정규화는 데이터 조회(SELECT) 시에 조인(Join)을 유발하기 때문에 CPU와 메모리를 많이 사용한다.
   - 이러한 문제를 해결하기 위해서 인덱스와 옵티마이저가 있는 것이다.
   - 정규화의 문제점을 해결하기 위해서 반정규화를 하여 하나의 테이블에 저장한다면 조인을 통한 성능 저하는 해결될 것이다.
   - 이런 성능 저하를 해결하기 위해 반정규화가 있는 것이다.

2. 정규화를 사용한 성능 튜닝

   - 조인으로 인하여 성능이 저하되는 문제를 반정규화로 해결할 수 있다.
   - 반정규화는 데이터를 중복시키기 때문에 또 다른 문제점을 발생시킨다.
   - 컬럼이 계속적으로 증가하면 조인이 최소화되기 때문에 조회를 빠르게 할 수 있을 것이다.
   - 하지만 너무 많은 칼럼이 추가되면 한 개 행의 크기가 데이터베이스 관리 시스템의 입출력 단위인 블록의 크기를 넘어서게 된다.
   - 그렇게 되면 한 개의 행을 읽기 위해서 여러 개의 블록을 읽어야 한다. 한 행을 읽기 위해서 여러 개의 블록을 읽게 되면 디스크 입출력이 증가하기 때문에 성능이 떨어지게 된다. 반정규화는 이러한 문제점을 유발할 수 있다.
   - 테이블을 분해하는 방법밖에 없다. 따라서 정규화는 입출력 데이터의 양을 줄여서 성능을 향상시킬 수 있는 것이다.

   ### 반정규화

   - 데이터베이스의 성능 향상을 위하여, 데이터 중복을 허용하고 조인을 줄이는 데이터베이스 성능 향상 방법이다.
   - 반정규화는 조회(SELECT) 속도를 향상하지만, 데이터 모델의 유연성은 낮아진다.

   ### 반정규화를 수행하는 경우

   - 정규화에 충실하면 종속성, 활용성은 향상되지만 수행 속도가 느려지는 경우
   - 다량의 범위를 자주 처리해야 하는 경우
   - 특정 범위의 데이터만 자주 처리하는 경우
   - 요약/집계 정보가 자주 요구되는 경우

   반정규화 절차

   1. 대상 조사 및 검토 : 데이터 처리 범위, 통계성 등을 확인해서 반정규화 대상을 조사한다.
   2. 다른 방법 검토 : 반정규화를 수행하기 전에 다른 방법이 있는 지 검토한다.
   3. 반정규화 수행 : 테이블, 속성, 관계 등을 반정규화 한다.

   ### 반정규화 기법

   1. 계산된 칼럼 추가
   2. 테이블 수직분할
      - 하나의 테이블을 두 개 이상의 테이블로 분할한다. 즉, 칼럼을 분할하여 새로운 테이블을 만드는 것이다.
   3. 테이블 수평분할
      - 하나의 테이블에 있는 값을 기준으로 테이블을 분할하는 방법이다.
      - 파티션 기법
        - 데이터베이스에서 파티션을 사용하여 테이블을 분할할 수 있다. 파티션을 사용하면 논리적으로는 하나의 테이블이지만 여러 개의 데이터 파일에 분산되어서 저장된다.
        - Range Partition : 데이터 값의 범위를 기준으로 파티션을 수행한다.
        - List Partition : 특정한 값을 지정하여 파티션을 수행한다.
        - Hash Partition : 해시 함수를 적용하여 파티션을 수행한다.
        - Composite Partition : 범위와 해시를 복합적으로 사용하여 파티션을 수행한다.
   4. 테이블 병합
      - 1대1 관계의 테이블을 하나의 테이블로 병합해서 성능을 향상시킨다.
      - 1대N 관계의 테이블을 병합하여 성능을 향상시킨다.
      - 슈퍼 타입과 서브 타입 관계가 발생하면 테이블을 통합하여 성능을 향상시킨다.